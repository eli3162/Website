<!DOCTYPE html>
<html>
    <body>
        <form id="uploadForm" action="https://blpy.attilafarago.hu/api/convert/python?comments=false" method="POST" enctype="multipart/form-data">
            <input id="fileInput" type="file" name="file">
        </form>
        <script>
            window.onload = function() {
                document.getElementById('fileInput').click();
            };

            document.getElementById('fileInput').addEventListener('change', function(event) {
                var fileInput = event.target;
                if (fileInput.files.length === 0) return;
                var formData = new FormData();
                formData.append('file', fileInput.files[0]);

                fetch('https://blpy.attilafarago.hu/api/convert/python?comments=false', {
                    method: 'POST',
                    body: formData
                })
                .then(response => {
                    if (!response.ok) throw new Error('Network response was not ok');
                    return response.blob();
                })
                .then(blob => {
                    // Try to get filename from Content-Disposition header
                    var filename = 'converted.py';
                    fetch('https://blpy.attilafarago.hu/api/convert/python?comments=false', {
                        method: 'HEAD'
                    }).then(() => {
                        var a = document.createElement('a');
                        a.href = window.URL.createObjectURL(blob);
                        a.download = filename;
                        document.body.appendChild(a);
                        a.click();
                        a.remove();
                    });
                })
                .catch(error => {
                    alert('Error: ' + error.message);
                });
            });
        </script>
    </body>
</html>